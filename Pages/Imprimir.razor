@page "/Imprimir"
@using Dent.Models
<h3>Imprimir</h3>

<div class="form-group">
    <label for="inputText">% en 3 Cuotas:</label>
    <input type="text" id="inputText" @bind="TresCuotasPorcentaje" />
</div>
<div class="form-group">
    <label for="inputText">% en 6 Cuotas:</label>
    <input type="text" id="inputText" @bind="SeisCuotasPorcentaje" />


</div>

<h3>Tabla de Practicas</h3>

<br />

<input type="text" id="inputText" @bind="PrimeraPracticaTitulo" readonly />
<input type="text" id="inputText" @bind="PrecioTitulo" size="8" readonly />
<input type="text" id="inputText" @bind="Efectivo20Menos1Titulo" size="8" readonly />
<input type="text" id="inputText" @bind="TresCuotas1Titulo" size="8" readonly />
<input type="text" id="inputText" @bind="SeisCuotas1Titulo" size="8" readonly />
<br />
<br />

<input type="text" id="inputText" @bind="PrimeraPractica" readonly />
<input type="text" id="inputText" @bind="PrimerPrecio" size="8" readonly />
<input type="text" id="inputText" @bind="Efectivo20Menos1" size="8" readonly />
<input type="text" id="inputText" @bind="TresCuotas1" size="8" readonly />
<input type="text" id="inputText" @bind="SeisCuotas1" size="8" readonly />
<button @onclick="() => EliminarFIla1(1)">X</button>
<br />

<input type="text" id="inputText" @bind="SegundaPractica" readonly />
<input type="text" id="inputText" @bind="SegundoPrecio" size="8" readonly />
<input type="text" id="inputText" @bind="Efectivo20Menos2" size="8" readonly />
<input type="text" id="inputText" @bind="TresCuotas2" size="8" readonly />
<input type="text" id="inputText" @bind="SeisCuotas2" size="8" readonly />
<button @onclick="() => EliminarFIla1(2)">X</button>
<br />

<input type="text" id="inputText" @bind="TerceraPractica" readonly />
<input type="text" id="inputText" @bind="TercerPrecio" size="8" readonly />
<input type="text" id="inputText" @bind="Efectivo20Menos3" size="8" readonly />
<input type="text" id="inputText" @bind="TresCuotas3" size="8" readonly />
<input type="text" id="inputText" @bind="SeisCuotas3" size="8" readonly />
<button @onclick="() => EliminarFIla1(3)">X</button>
<br />

<input type="text" id="inputText" @bind="CuartaPractica" readonly />
<input type="text" id="inputText" @bind="CuartoPrecio" size="8" readonly />
<input type="text" id="inputText" @bind="Efectivo20Menos4" size="8" readonly />
<input type="text" id="inputText" @bind="TresCuotas4" size="8" readonly />
<input type="text" id="inputText" @bind="SeisCuotas4" size="8" readonly />
<button @onclick="() => EliminarFIla1(4)">X</button>
<br />

<input type="text" id="inputText" @bind="QuintaPractica" readonly />
<input type="text" id="inputText" @bind="QuintoPrecio" size="8" readonly />
<input type="text" id="inputText" @bind="Efectivo20Menos5" size="8" readonly />
<input type="text" id="inputText" @bind="TresCuotas5" size="8" readonly />
<input type="text" id="inputText" @bind="SeisCuotas5" size="8" readonly />
<button @onclick="() => EliminarFIla1(5)">X</button>
<br />

<input type="text" id="inputText" @bind="TotalLabel" readonly />
<input type="text" id="inputText" @bind="TotalDebito" size="8" readonly />
<input type="text" id="inputText" @bind="TotalEfectivo" size="8" readonly />
<input type="text" id="inputText" @bind="Total3Cuotas" size="8" readonly />
<input type="text" id="inputText" @bind="Total6Cuotas" size="8" readonly />
<br />
<br />
<table class="table">
    <thead>
        <tr>
            <th>ID</th>
            <th>Practica</th>
            <th>Precio</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var practica in ListaDePracticas)
        {
            <tr>
                <td>@practica.Id</td>
                <td>@practica.Practica</td>
                <td>@practica.Precio</td>
                <td>
                    <button @onclick="() => Agregar(practica.Id)">Agregar</button>
                </td>
            </tr>
        }
    </tbody>
</table>
<!--
<table class="table">
    <thead>
        <tr>
            <th>Practica</th>
            <th>Precio</th>
        </tr>
    </thead>
    <tbody>
            <tr>
                <td>practica.Practica</td>
                <td>practica.Precio</td>
                <td>
                    <button @onclick="() => Quitar(12)">Quitar</button>
                </td>
            </tr>        
    </tbody>
</table>
    -->
@code {
    // VARIABLES DE LA ULTIMA LINEA DE LA TABLA HARCODEADA//
    public string TotalLabel = "TOTAL:";
    public int TotalDebito = 0;
    public int TotalEfectivo = 0;
    public int Total3Cuotas = 0;
    public int Total6Cuotas = 0;
    /////////////////////////////////////////////////////////

    public string PrimeraPracticaTitulo = "PRACTICA";
    public string PrecioTitulo = "DEBITO";
    public string Efectivo20Menos1Titulo = "EFECTIVO";
    public string TresCuotas1Titulo = "3 CUOTAS";
    public string SeisCuotas1Titulo = "6 CUOTAS";
    public string PrimeraPractica = "-";
    public string SegundaPractica = "-";
    public string TerceraPractica = "-";
    public string CuartaPractica = "-";
    public string QuintaPractica = "-";
    public int TresCuotasPorcentaje = 30;
    public int SeisCuotasPorcentaje = 60;
    public int TresCuotas = 0;
    public int TresCuotas1 = 0;
    public int TresCuotas2 = 0;
    public int TresCuotas3 = 0;
    public int TresCuotas4 = 0;
    public int TresCuotas5 = 0;
    public int SeisCuotas = 0;
    public int SeisCuotas1 = 0;
    public int SeisCuotas2 = 0;
    public int SeisCuotas3 = 0;
    public int SeisCuotas4 = 0;
    public int SeisCuotas5 = 0;
    public int Efectivo20Menos = 0;
    public int Efectivo20Menos1 = 0;
    public int Efectivo20Menos2 = 0;
    public int Efectivo20Menos3 = 0;
    public int Efectivo20Menos4 = 0;
    public int Efectivo20Menos5 = 0;
    public int PrimerPrecio = 0;
    public int SegundoPrecio = 0;
    public int TercerPrecio = 0;
    public int CuartoPrecio = 0;
    public int QuintoPrecio = 0;
    private List<Practica1> ListaDePracticas = new List<Practica1>();

    [Inject]
    private DbDentistaContext DbContext { get; set; }

    protected override void OnInitialized()
    {
        ListaDePracticas = DbContext.Practicas.ToList();
    }

    public (int,int,int) ObtenerResultados(int PrecioPasado)
    {
        Efectivo20Menos = Convert.ToInt32(PrecioPasado * 0.8);
        TresCuotas = Convert.ToInt32(((PrecioPasado * TresCuotasPorcentaje) / 100) + PrecioPasado);
        SeisCuotas = Convert.ToInt32(((PrecioPasado * SeisCuotasPorcentaje) / 100) + PrecioPasado);
        var asd = (Efectivo20Menos, TresCuotas, SeisCuotas);
        var sda = asd.GetType();
        return asd;
    }
    public void CargarTotales()
    {
        TotalDebito = PrimerPrecio + SegundoPrecio + TercerPrecio + CuartoPrecio + QuintoPrecio;
        TotalEfectivo = Efectivo20Menos1 + Efectivo20Menos2 + Efectivo20Menos3 + Efectivo20Menos4 + Efectivo20Menos5;
        Total3Cuotas = TresCuotas1 + TresCuotas2 + TresCuotas3 + TresCuotas4 + TresCuotas5;
        Total6Cuotas = SeisCuotas1 + SeisCuotas2 + SeisCuotas3 + SeisCuotas4 + SeisCuotas5;

    }
    private void EliminarFIla1(int FilaAEliminar)
    {
        if (FilaAEliminar == 1)
        {
            PrimeraPractica = "-";
            PrimerPrecio = 0;
            ObtenerResultados(0);
            Efectivo20Menos1 = Efectivo20Menos;
            TresCuotas1 = TresCuotas;
            SeisCuotas1 = SeisCuotas;

        }
        else if (FilaAEliminar == 2)
        {
            SegundaPractica = "-";
            SegundoPrecio = 0;
            ObtenerResultados(0);
            Efectivo20Menos2 = Efectivo20Menos;
            TresCuotas2 = TresCuotas;
            SeisCuotas2 = SeisCuotas;
        }
        else if (FilaAEliminar == 3)
        {  
            TerceraPractica = "-";
            TercerPrecio = 0;
            ObtenerResultados(0);
            Efectivo20Menos3 = Efectivo20Menos;
            TresCuotas3 = TresCuotas;
            SeisCuotas3 = SeisCuotas;
        }
        else if (FilaAEliminar == 4)
        { 
            CuartaPractica = "-";
            CuartoPrecio = 0;
            ObtenerResultados(0);
            Efectivo20Menos4 = Efectivo20Menos;
            TresCuotas4 = TresCuotas;
            SeisCuotas4 = SeisCuotas;
        }
        else if (FilaAEliminar == 5)
        {
            QuintaPractica = "-";
            QuintoPrecio = 0;
            ObtenerResultados(0);
            Efectivo20Menos5 = Efectivo20Menos;
            TresCuotas5 = TresCuotas;
            SeisCuotas5 = SeisCuotas;
        }

        CargarTotales();
        }

    private void Quitar(int practicaId)
    {
    }

    private void Agregar(int practicaId)
    {
        if (PrimeraPractica == "-")
        {


            var practica = DbContext.Practicas.Find(practicaId);

            PrimeraPractica = practica.Practica.ToString();
            PrimerPrecio = Convert.ToInt32(practica.Precio.ToString());

            ObtenerResultados(PrimerPrecio);
            Efectivo20Menos1 = Efectivo20Menos;
            TresCuotas1 = TresCuotas;
            SeisCuotas1 = SeisCuotas;
        }
        else if (SegundaPractica == "-")
        {
            var practica = DbContext.Practicas.Find(practicaId);
            SegundaPractica = practica.Practica.ToString();
            SegundoPrecio = Convert.ToInt32(practica.Precio.ToString());
            ObtenerResultados(SegundoPrecio);
            Efectivo20Menos2 = Efectivo20Menos;
            TresCuotas2 = TresCuotas;
            SeisCuotas2 = SeisCuotas;
        }
        else if (TerceraPractica == "-")
        {
            var practica = DbContext.Practicas.Find(practicaId);
            TerceraPractica = practica.Practica.ToString();
            TercerPrecio = Convert.ToInt32(practica.Precio.ToString());
            ObtenerResultados(TercerPrecio);
            Efectivo20Menos3 = Efectivo20Menos;
            TresCuotas3 = TresCuotas;
            SeisCuotas3 = SeisCuotas;
        }
        else if (CuartaPractica == "-")
        {
            var practica = DbContext.Practicas.Find(practicaId);
            CuartaPractica = practica.Practica.ToString();
            CuartoPrecio = Convert.ToInt32(practica.Precio.ToString());
            ObtenerResultados(CuartoPrecio);
            Efectivo20Menos4 = Efectivo20Menos;
            TresCuotas4 = TresCuotas;
            SeisCuotas4 = SeisCuotas;

        }
        else if (QuintaPractica == "-")
        {
            var practica = DbContext.Practicas.Find(practicaId);
            QuintaPractica = practica.Practica.ToString();
            QuintoPrecio = Convert.ToInt32(practica.Precio.ToString());
            ObtenerResultados(QuintoPrecio);
            Efectivo20Menos5 = Efectivo20Menos;
            TresCuotas5 = TresCuotas;
            SeisCuotas5 = SeisCuotas;

        }
        CargarTotales();

        }

        
    }

